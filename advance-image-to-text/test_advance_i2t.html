<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Groq Vision (Llama 3.2)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 40px; max-width: 700px; margin: 0 auto; background-color: #f4f4f9; }
        .box { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: #f55036; text-align: center; margin-bottom: 30px; } /* M√†u cam ƒë·∫∑c tr∆∞ng c·ªßa Groq */
        
        label { font-weight: bold; display: block; margin-bottom: 8px; color: #333; }
        input[type="file"] { margin-bottom: 20px; width: 100%; padding: 10px; background: #eee; border-radius: 6px; }
        
        textarea { width: 100%; height: 80px; margin-bottom: 20px; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; resize: vertical; }
        
        button { width: 100%; padding: 12px; background: #f55036; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; transition: background 0.3s; }
        button:hover { background: #d43d25; }
        
        #result { margin-top: 25px; padding: 20px; border-radius: 8px; background: #fff; border: 1px solid #e0e0e0; min-height: 50px; white-space: pre-wrap; line-height: 1.6; }
        .loading { color: #f55036; font-style: italic; font-weight: bold; text-align: center; display: block; }
        .error { color: red; background: #ffe6e6; padding: 10px; border-radius: 6px; }
    </style>
</head>
<body>
    <h1>‚ö° Test Groq Vision AI</h1>
    
    <div class="box">
        <label>1. Ch·ªçn ·∫£nh c·∫ßn ph√¢n t√≠ch:</label>
        <input type="file" id="imageInput" accept="image/*">

        <label>2. B·∫°n mu·ªën AI l√†m g√¨?</label>
        <textarea id="promptInput" placeholder="V√≠ d·ª•: M√¥ t·∫£ chi ti·∫øt b·ª©c ·∫£nh n√†y..."></textarea>
        <div style="font-size: 0.85em; color: #666; margin-top: -15px; margin-bottom: 20px;">
            <i>G·ª£i √Ω: "Tr√≠ch xu·∫•t ch·ªØ trong ·∫£nh (OCR)", "Li·ªát k√™ danh s√°ch ƒë·ªì v·∫≠t d·∫°ng JSON", "D·ªãch menu n√†y sang ti·∫øng Vi·ªát"...</i>
        </div>

        <button onclick="sendRequest()">üöÄ G·ª≠i y√™u c·∫ßu</button>

        <div id="result">K·∫øt qu·∫£ s·∫Ω hi·ªán ·ªü ƒë√¢y...</div>
    </div>

    <script>
        async function sendRequest() {
            const fileInput = document.getElementById('imageInput');
            const promptInput = document.getElementById('promptInput');
            const resultDiv = document.getElementById('result');

            if (!fileInput.files[0]) {
                alert("‚ö†Ô∏è Vui l√≤ng ch·ªçn ·∫£nh tr∆∞·ªõc!");
                return;
            }

            // Hi·ªÉn th·ªã loading
            resultDiv.innerHTML = '<span class="loading">ƒêang g·ª≠i sang Groq (Llama 3.2)... ch·ªù ch√∫t nh√© ‚è≥</span>';

            const formData = new FormData();
            formData.append("image", fileInput.files[0]);
            // N·∫øu kh√¥ng nh·∫≠p g√¨, d√πng prompt m·∫∑c ƒë·ªãnh
            formData.append("prompt", promptInput.value || "Describe this image in detail");

            try {
                // G·ªçi v√†o main.py ƒëang ch·∫°y ·ªü port 5002
                const response = await fetch("http://127.0.0.1:5002/caption", {
                    method: "POST",
                    body: formData
                });

                const data = await response.json();

                if (data.error) {
                    resultDiv.innerHTML = `<div class="error">‚ùå L·ªói: ${data.caption}</div>`;
                } else {
                    resultDiv.innerHTML = `<b>‚úÖ K·∫øt qu·∫£:</b><br>${data.caption}`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå L·ªói k·∫øt n·ªëi server: ${error.message}<br>ƒê·∫£m b·∫£o b·∫°n ƒë√£ ch·∫°y file main.py!</div>`;
            }
        }
    </script>
</body>
</html>